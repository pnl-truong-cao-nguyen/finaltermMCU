CCS PCM C Compiler, Version 5.112, 5967               01-Feb-23 00:26

               Filename:   D:\OneDrive - The University of Technology\documents_pnl\DUT\dai_hoc_nam_3\HocKy1\kiThuatViDieuKhien\finaltermMCU\PICC\main.lst

               ROM used:   343 words (4%)
                           Largest free fragment is 2048
               RAM used:   25 (7%) at main() level
                           31 (8%) worst case
               Stack used: 2 locations (0 in main + 2 for interrupts)
               Stack size: 8

*
0000:  MOVLW  01
0001:  MOVWF  0A
0002:  GOTO   11E
0003:  NOP
0004:  MOVWF  7F
0005:  SWAPF  03,W
0006:  CLRF   03
0007:  MOVWF  21
0008:  MOVF   0A,W
0009:  MOVWF  20
000A:  CLRF   0A
000B:  MOVF   04,W
000C:  MOVWF  22
000D:  MOVF   77,W
000E:  MOVWF  23
000F:  MOVF   78,W
0010:  MOVWF  24
0011:  MOVF   79,W
0012:  MOVWF  25
0013:  MOVF   7A,W
0014:  MOVWF  26
0015:  BCF    03.7
0016:  BCF    03.5
0017:  BTFSS  0B.4
0018:  GOTO   01B
0019:  BTFSC  0B.1
001A:  GOTO   030
001B:  BTFSS  0B.5
001C:  GOTO   01F
001D:  BTFSC  0B.2
001E:  GOTO   033
001F:  MOVF   22,W
0020:  MOVWF  04
0021:  MOVF   23,W
0022:  MOVWF  77
0023:  MOVF   24,W
0024:  MOVWF  78
0025:  MOVF   25,W
0026:  MOVWF  79
0027:  MOVF   26,W
0028:  MOVWF  7A
0029:  MOVF   20,W
002A:  MOVWF  0A
002B:  SWAPF  21,W
002C:  MOVWF  03
002D:  SWAPF  7F,F
002E:  SWAPF  7F,W
002F:  RETFIE
0030:  BCF    0A.3
0031:  BCF    0A.4
0032:  GOTO   036
0033:  BCF    0A.3
0034:  BCF    0A.4
0035:  GOTO   07E
.................... #include <main.h>
.................... #include <16F877A.h>
.................... //////////// Standard Header file for the PIC16F877A device ////////////////
.................... ///////////////////////////////////////////////////////////////////////////
.................... ////        (C) Copyright 1996, 2020 Custom Computer Services          ////
.................... //// This source code may only be used by licensed users of the CCS C  ////
.................... //// compiler.  This source code may only be distributed to other      ////
.................... //// licensed users of the CCS C compiler.  No other use, reproduction ////
.................... //// or distribution is permitted without written permission.          ////
.................... //// Derivative programs created using this software in object code    ////
.................... //// form are not restricted in any way.                               ////
.................... ///////////////////////////////////////////////////////////////////////////
.................... #device PIC16F877A
*
00F0:  MOVF   36,W
00F1:  CLRF   78
00F2:  SUBWF  35,W
00F3:  BTFSC  03.0
00F4:  GOTO   0F8
00F5:  MOVF   35,W
00F6:  MOVWF  77
00F7:  GOTO   104
00F8:  CLRF   77
00F9:  MOVLW  08
00FA:  MOVWF  37
00FB:  RLF    35,F
00FC:  RLF    77,F
00FD:  MOVF   36,W
00FE:  SUBWF  77,W
00FF:  BTFSC  03.0
0100:  MOVWF  77
0101:  RLF    78,F
0102:  DECFSZ 37,F
0103:  GOTO   0FB
0104:  RETURN
.................... 
.................... #list
.................... 
.................... #include <DEF_16F877A.h>
.................... /**
....................   ******************************************************************************
....................   * Ten Tep      :        DEF_16F877A.h
....................   * Tac Gia      :        Nguyen Quy Nhat
....................   * Cong Ty      :        MinhHaGroup
....................   * Website      :        BanLinhKien.Vn
....................   * Phien Ban    :        V1.0.0
....................   * Ngay         :        31-08-2012
....................   * Tom Tat      :        Khai bao, dinh nghia mot so thah ghi cho PIC16F877A
....................   *           
....................   *
....................   ******************************************************************************
....................   * Chu Y      :          
....................   *                          
....................   *                      
....................   ******************************************************************************
....................   */
.................... #ifndef __DEF_16F877A_H
.................... #define __DEF_16F877A_H
.................... #byte PORTA           = 0x05
.................... #byte PORTB           = 0x06
.................... #byte PORTC           = 0x07
.................... #byte PORTD           = 0x08
.................... #byte PORTE           = 0x09
.................... #byte PINA            = 0x05
.................... #byte PINB            = 0x06
.................... #byte PINC            = 0x07
.................... #byte PIND            = 0x08
.................... #byte PINE            = 0x09
.................... //Thanh Ghi Huong
.................... #byte DDRA            = 0x85
.................... #byte DDRB            = 0x86
.................... #byte DDRC            = 0x87
.................... #byte DDRD            = 0x88
.................... #byte DDRE            = 0x89
.................... /*********************PORTA**********************/
.................... #bit PORTA_5          = PORTA.5
.................... #bit PORTA_4          = PORTA.4
.................... #bit PORTA_3          = PORTA.3
.................... #bit PORTA_2          = PORTA.2
.................... #bit PORTA_1          = PORTA.1
.................... #bit PORTA_0          = PORTA.0
.................... #bit PINA_0           = PINA.0
.................... #bit PINA_1           = PINA.1
.................... #bit PINA_2           = PINA.2
.................... #bit PINA_3           = PINA.3
.................... #bit PINA_4           = PINA.4
.................... #bit PINA_5           = PINA.5
.................... #bit DDRA_0           = DDRA.0
.................... #bit DDRA_1           = DDRA.1
.................... #bit DDRA_2           = DDRA.2
.................... #bit DDRA_3           = DDRA.3
.................... #bit DDRA_4           = DDRA.4
.................... /*********************PORTB**********************/
.................... #bit PORTB_7          = PORTB.7
.................... #bit PORTB_6          = PORTB.6
.................... #bit PORTB_5          = PORTB.5
.................... #bit PORTB_4          = PORTB.4
.................... #bit PORTB_3          = PORTB.3
.................... #bit PORTB_2          = PORTB.2
.................... #bit PORTB_1          = PORTB.1
.................... #bit PORTB_0          = PORTB.0
.................... #bit PINB_7           = PINB.7
.................... #bit PINB_6           = PINB.6
.................... #bit PINB_5           = PINB.5
.................... #bit PINB_4           = PINB.4
.................... #bit PINB_3           = PINB.3
.................... #bit PINB_2           = PINB.2
.................... #bit PINB_1           = PINB.1
.................... #bit PINB_0           = PINB.0
.................... #bit DDRB_0           = DDRB.0
.................... #bit DDRB_1           = DDRB.1
.................... #bit DDRB_2           = DDRB.2
.................... #bit DDRB_3           = DDRB.3
.................... #bit DDRB_4           = DDRB.4
.................... #bit DDRB_5           = DDRB.5
.................... #bit DDRB_6           = DDRB.6
.................... #bit DDRB_7           = DDRB.7
.................... /*********************PORTC**********************/
.................... #bit PORTC_7          = PORTC.7
.................... #bit PORTC_6          = PORTC.6
.................... #bit PORTC_5          = PORTC.5
.................... #bit PORTC_4          = PORTC.4
.................... #bit PORTC_3          = PORTC.3
.................... #bit PORTC_2          = PORTC.2
.................... #bit PORTC_1          = PORTC.1
.................... #bit PORTC_0          = PORTC.0
.................... #bit PINC_7           = PINC.7
.................... #bit PINC_6           = PINC.6
.................... #bit PINC_5           = PINC.5
.................... #bit PINC_4           = PINC.4
.................... #bit PINC_3           = PINC.3
.................... #bit PINC_2           = PINC.2
.................... #bit PINC_1           = PINC.1
.................... #bit PINC_0           = PINC.0
.................... #bit DDRC_0           = DDRC.0
.................... #bit DDRC_1           = DDRC.1
.................... #bit DDRC_2           = DDRC.2
.................... #bit DDRC_3           = DDRC.3
.................... #bit DDRC_4           = DDRC.4
.................... #bit DDRC_5           = DDRC.5
.................... #bit DDRC_6           = DDRC.6
.................... #bit DDRC_7           = DDRC.7
.................... /*********************PORTD**********************/
.................... #bit PORTD_7          = PORTD.7
.................... #bit PORTD_6          = PORTD.6
.................... #bit PORTD_5          = PORTD.5
.................... #bit PORTD_4          = PORTD.4
.................... #bit PORTD_3          = PORTD.3
.................... #bit PORTD_2          = PORTD.2
.................... #bit PORTD_1          = PORTD.1
.................... #bit PORTD_0          = PORTD.0
.................... #bit PIND_7           = PIND.7
.................... #bit PIND_6           = PIND.6
.................... #bit PIND_5           = PIND.5
.................... #bit PIND_4           = PIND.4
.................... #bit PIND_3           = PIND.3
.................... #bit PIND_2           = PIND.2
.................... #bit PIND_1           = PIND.1
.................... #bit PIND_0           = PIND.0
.................... #bit DDRD_0           = DDRD.0
.................... #bit DDRD_1           = DDRD.1
.................... #bit DDRD_2           = DDRD.2
.................... #bit DDRD_3           = DDRD.3
.................... #bit DDRD_4           = DDRD.4
.................... #bit DDRD_5           = DDRD.5
.................... #bit DDRD_6           = DDRD.6
.................... #bit DDRD_7           = DDRD.7
.................... /*********************PORTE**********************/
.................... #bit PORTE_2          = PORTE.2
.................... #bit PORTE_1          = PORTE.1
.................... #bit PORTE_0          = PORTE.0
.................... #bit PINE_2           = PINE.2
.................... #bit PINE_1           = PINE.1
.................... #bit PINE_0           = PINE.0
.................... #bit DDRE_0           = DDRE.0
.................... #bit DDRE_1           = DDRE.1
.................... #bit DDRE_2           = DDRE.2
.................... #ifndef DDR_OUT
....................     #define DDR_OUT     0
.................... #endif
.................... #ifndef DDR_IN
....................     #define DDR_IN      1
.................... #endif
.................... #endif
.................... /******************************KET THUC FILE******************************
.................... ______________________________NGUYEN QUY NHAT______________________________*/
.................... 
.................... 
.................... #device ADC=10
.................... #use delay(crystal=20000000)
*
006A:  MOVLW  38
006B:  MOVWF  04
006C:  BCF    03.7
006D:  MOVF   00,W
006E:  BTFSC  03.2
006F:  GOTO   07D
0070:  MOVLW  06
0071:  MOVWF  78
0072:  CLRF   77
0073:  DECFSZ 77,F
0074:  GOTO   073
0075:  DECFSZ 78,F
0076:  GOTO   072
0077:  MOVLW  7B
0078:  MOVWF  77
0079:  DECFSZ 77,F
007A:  GOTO   079
007B:  DECFSZ 00,F
007C:  GOTO   070
007D:  RETURN
.................... #fuses NOWDT, HS, NOLVP, NOPUT, NOPROTECT, NODEBUG, NOBROWNOUT, NOCPD, NOWRT
.................... 
.................... 
.................... 
.................... unsigned int8 seg7ledca[10] = {0xC0, 0xF9, 0xA4, 0xB0, 0x99, 0x92, 0x82, 0xF8, 0x80, 0x90};//7 segment led code common anode
*
012C:  MOVLW  C0
012D:  BCF    03.5
012E:  MOVWF  27
012F:  MOVLW  F9
0130:  MOVWF  28
0131:  MOVLW  A4
0132:  MOVWF  29
0133:  MOVLW  B0
0134:  MOVWF  2A
0135:  MOVLW  99
0136:  MOVWF  2B
0137:  MOVLW  92
0138:  MOVWF  2C
0139:  MOVLW  82
013A:  MOVWF  2D
013B:  MOVLW  F8
013C:  MOVWF  2E
013D:  MOVLW  80
013E:  MOVWF  2F
013F:  MOVLW  90
0140:  MOVWF  30
.................... 
.................... unsigned int8 n = 0;
.................... unsigned int16 i = 0;
.................... 
.................... //=========================declare function====================================
.................... void init_pin(void)
.................... {
.................... // set up port
....................    DDRA_0 = 1;//button on/off sensor
*
00B3:  BSF    03.5
00B4:  BSF    05.0
....................    DDRA_1 = 1;//button on/off light
00B5:  BSF    05.1
....................    DDRA_2 = 1;//button reset count
00B6:  BSF    05.2
....................    DDRB_0 = 1;//input sensor
00B7:  BSF    06.0
....................    DDRB_1 = 0;//signal led green
00B8:  BCF    06.1
....................    DDRB_2 = 0;//signal led yellow
00B9:  BCF    06.2
....................    DDRB_3 = 0;//signal led red
00BA:  BCF    06.3
....................    DDRB_4 = 0;//light
00BB:  BCF    06.4
....................    DDRB_5 = 0;//signal sensor led
00BC:  BCF    06.5
....................    DDRC = 0x00;//7 segment led dozens
00BD:  CLRF   07
....................    DDRD = 0x00;//7 segment led units
00BE:  CLRF   08
00BF:  BCF    03.5
00C0:  BCF    0A.3
00C1:  BCF    0A.4
00C2:  GOTO   142 (RETURN)
.................... }
.................... 
.................... void init_int_ext(void);//init interrupt external
.................... 
.................... void status_on_off(unsigned int8 n);//notification status
.................... 
.................... void display_on_seg7led(unsigned int8 n);//export 7 segment led
.................... 
.................... void init_int_timer0(void);//init interrupt timer 0
.................... 
.................... //=====================declare interrupt program===============================
.................... #INT_EXT
.................... void _int_ext(void)
.................... {
....................    PORTB_4 = 1;
*
0036:  BSF    06.4
....................    i = 0;
0037:  CLRF   33
0038:  CLRF   32
....................    do
....................    {
....................       set_timer1(0);
0039:  CLRF   0E
003A:  CLRF   0F
003B:  CLRF   0E
003C:  NOP
....................       while(get_timer1() < 50000)
003D:  MOVF   0F,W
003E:  MOVWF  7A
003F:  MOVF   0E,W
0040:  MOVWF  77
0041:  MOVF   0F,W
0042:  SUBWF  7A,W
0043:  BTFSS  03.2
0044:  GOTO   03D
0045:  MOVF   77,W
0046:  MOVWF  38
0047:  MOVF   7A,W
0048:  MOVWF  39
0049:  MOVF   39,W
004A:  SUBLW  C3
004B:  BTFSS  03.0
004C:  GOTO   05A
004D:  BTFSS  03.2
004E:  GOTO   053
004F:  MOVF   38,W
0050:  SUBLW  4F
0051:  BTFSS  03.0
0052:  GOTO   05A
....................       {
....................          if(PORTB_0)
0053:  BTFSS  06.0
0054:  GOTO   059
....................          {
....................             i = 0;
0055:  CLRF   33
0056:  CLRF   32
....................             while(PORTB_0);
0057:  BTFSC  06.0
0058:  GOTO   057
....................          }
0059:  GOTO   03D
....................       }
....................       i++;
005A:  INCF   32,F
005B:  BTFSC  03.2
005C:  INCF   33,F
....................    }
....................    while(i < 100);
005D:  MOVF   33,F
005E:  BTFSS  03.2
005F:  GOTO   064
0060:  MOVF   32,W
0061:  SUBLW  63
0062:  BTFSC  03.0
0063:  GOTO   039
....................    
....................    PORTB_4 = 0;
0064:  BCF    06.4
....................    n++;
0065:  INCF   31,F
.................... }
.................... 
0066:  BCF    0B.1
0067:  BCF    0A.3
0068:  BCF    0A.4
0069:  GOTO   01F
.................... #INT_TIMER0
.................... void _int_timer0(void)
.................... {
....................    if(PORTA_0)
*
007E:  BTFSS  05.0
007F:  GOTO   08F
....................    {
....................       //on/off sensor
....................       delay_ms(20);
0080:  MOVLW  14
0081:  MOVWF  38
0082:  CALL   06A
....................       if(PORTA_0)
0083:  BTFSS  05.0
0084:  GOTO   08F
....................       {
....................          DDRB_0 = !DDRB_0;
0085:  MOVLW  01
0086:  BSF    03.5
0087:  XORWF  06,F
....................          while(PORTA_0);
0088:  BCF    03.5
0089:  BTFSC  05.0
008A:  GOTO   089
....................          if(PORTB_4)
008B:  BTFSS  06.4
008C:  GOTO   08F
....................          {
....................             PORTB_4 = 0;
008D:  BCF    06.4
....................             n++;
008E:  INCF   31,F
....................          }
....................       }     
....................    }
....................    if(DDRB_0 == 0)
008F:  BSF    03.5
0090:  BTFSC  06.0
0091:  GOTO   0A1
....................    {
....................       if(PORTA_1)
0092:  BCF    03.5
0093:  BTFSS  05.1
0094:  GOTO   0A0
....................       {
....................          //on/off light when sensor off
....................          delay_ms(20);
0095:  MOVLW  14
0096:  MOVWF  38
0097:  CALL   06A
....................          if(PORTA_1)
0098:  BTFSS  05.1
0099:  GOTO   0A0
....................          {
....................             PORTB_4 = !PORTB_4;
009A:  MOVLW  10
009B:  XORWF  06,F
....................             if(!PORTB_4)
009C:  BTFSS  06.4
....................             {
....................                n++;
009D:  INCF   31,F
....................             }
....................             while(PORTA_1);
009E:  BTFSC  05.1
009F:  GOTO   09E
00A0:  BSF    03.5
....................          }   
....................       }
....................    }
....................    if(PORTA_2)
00A1:  BCF    03.5
00A2:  BTFSS  05.2
00A3:  GOTO   0AD
....................    {
....................       //reset counter on/off light
....................       delay_ms(20);
00A4:  MOVLW  14
00A5:  MOVWF  38
00A6:  CALL   06A
....................       if(PORTA_2)
00A7:  BTFSS  05.2
00A8:  GOTO   0AD
....................       {
....................          n = 0;
00A9:  CLRF   31
....................          PORTB_4 = 0;
00AA:  BCF    06.4
....................          while(PORTA_2);
00AB:  BTFSC  05.2
00AC:  GOTO   0AB
....................       }
....................       
....................    }
....................    set_timer0(231);
00AD:  MOVLW  E7
00AE:  MOVWF  01
00AF:  BCF    0B.2
00B0:  BCF    0A.3
00B1:  BCF    0A.4
00B2:  GOTO   01F
.................... }
.................... 
.................... 
.................... //===========================main program======================================
.................... void main()
*
011E:  MOVF   03,W
011F:  ANDLW  1F
0120:  MOVWF  03
0121:  CLRF   31
0122:  CLRF   33
0123:  CLRF   32
0124:  BSF    03.5
0125:  BSF    1F.0
0126:  BSF    1F.1
0127:  BSF    1F.2
0128:  BCF    1F.3
0129:  MOVLW  07
012A:  MOVWF  1C
012B:  BCF    03.7
.................... {
....................    init_pin();
*
0141:  GOTO   0B3
....................    init_int_ext();
0142:  GOTO   0C3
....................    init_int_timer0();
0143:  GOTO   0CC
....................    setup_timer_1(T1_INTERNAL|T1_DIV_BY_1);//set timer1
0144:  MOVLW  85
0145:  MOVWF  10
....................    
....................    while(TRUE)
....................    {
....................       status_on_off(n);
0146:  MOVF   31,W
0147:  MOVWF  34
0148:  GOTO   0DA
....................       display_on_seg7led(n);
0149:  MOVF   31,W
014A:  MOVWF  34
014B:  GOTO   105
....................       if(DDRB_0)
014C:  BSF    03.5
014D:  BTFSS  06.0
014E:  GOTO   153
....................       {
....................          PORTB_5 = 1;//sensor on
014F:  BCF    03.5
0150:  BSF    06.5
....................       }
0151:  GOTO   155
0152:  BSF    03.5
....................       else
....................       {
....................          PORTB_5 = 0;//sensor off
0153:  BCF    03.5
0154:  BCF    06.5
....................       }
0155:  GOTO   146
....................    }
.................... }
.................... 
0156:  SLEEP
.................... //==================================function===================================
.................... void init_int_ext(void)
.................... {
....................    //interrupt at RB0
....................    ext_int_edge(L_TO_H);
*
00C3:  BSF    03.5
00C4:  BSF    01.6
....................    enable_interrupts(INT_EXT);
00C5:  BCF    03.5
00C6:  BSF    0B.4
....................    enable_interrupts(GLOBAL);
00C7:  MOVLW  C0
00C8:  IORWF  0B,F
00C9:  BCF    0A.3
00CA:  BCF    0A.4
00CB:  GOTO   143 (RETURN)
.................... }
.................... 
.................... void init_int_timer0(void)
.................... {
....................    //interrupt timer 0
....................    setup_timer_0(T0_INTERNAL|T0_DIV_1);
00CC:  BSF    03.5
00CD:  MOVF   01,W
00CE:  ANDLW  C7
00CF:  IORLW  08
00D0:  MOVWF  01
....................    set_timer0(231);
00D1:  MOVLW  E7
00D2:  BCF    03.5
00D3:  MOVWF  01
....................    enable_interrupts(INT_TIMER0);
00D4:  BSF    0B.5
....................    enable_interrupts(GLOBAL);
00D5:  MOVLW  C0
00D6:  IORWF  0B,F
00D7:  BCF    0A.3
00D8:  BCF    0A.4
00D9:  GOTO   144 (RETURN)
.................... }
.................... 
.................... void status_on_off(unsigned int8 n)
.................... {
....................    if(n < 10)
00DA:  MOVF   34,W
00DB:  SUBLW  09
00DC:  BTFSS  03.0
00DD:  GOTO   0E2
....................    {
....................       //green led
....................       PORTB_1 = 1;
00DE:  BSF    06.1
....................       PORTB_2 = 0;
00DF:  BCF    06.2
....................       PORTB_3 = 0;
00E0:  BCF    06.3
....................    }
00E1:  GOTO   0ED
....................    else if(n < 20)
00E2:  MOVF   34,W
00E3:  SUBLW  13
00E4:  BTFSS  03.0
00E5:  GOTO   0EA
....................    {
....................       //yellow led
....................       PORTB_1 = 0;
00E6:  BCF    06.1
....................       PORTB_2 = 1;
00E7:  BSF    06.2
....................       PORTB_3 = 0;
00E8:  BCF    06.3
....................    }
00E9:  GOTO   0ED
....................    else
....................    {
....................       //red led
....................       PORTB_1 = 0;
00EA:  BCF    06.1
....................       PORTB_2 = 0;
00EB:  BCF    06.2
....................       PORTB_3 = 1;
00EC:  BSF    06.3
....................    }
00ED:  BCF    0A.3
00EE:  BCF    0A.4
00EF:  GOTO   149 (RETURN)
.................... }
.................... 
.................... void display_on_seg7led(unsigned int8 n)
.................... {
....................    PORTC = seg7ledca[n/10];//7 segment led dozens
*
0105:  MOVF   34,W
0106:  MOVWF  35
0107:  MOVLW  0A
0108:  MOVWF  36
0109:  CALL   0F0
010A:  MOVLW  27
010B:  ADDWF  78,W
010C:  MOVWF  04
010D:  BCF    03.7
010E:  MOVF   00,W
010F:  MOVWF  07
....................    PORTD = seg7ledca[n%10];//7 segment led units
0110:  MOVF   34,W
0111:  MOVWF  35
0112:  MOVLW  0A
0113:  MOVWF  36
0114:  CALL   0F0
0115:  MOVLW  27
0116:  ADDWF  77,W
0117:  MOVWF  04
0118:  BCF    03.7
0119:  MOVF   00,W
011A:  MOVWF  08
011B:  BCF    0A.3
011C:  BCF    0A.4
011D:  GOTO   14C (RETURN)
.................... }

Configuration Fuses:
   Word  1: 3F3A   HS NOWDT NOPUT NOBROWNOUT NOLVP NOCPD NOWRT NODEBUG NOPROTECT
